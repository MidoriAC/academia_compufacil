<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Bootstrap JS -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
<div class="card">
  <div class="card-header border-0 pt-6">
    <div class="card-title">
      <h3>Tareas Entregadas</h3>
    </div>
  </div>

  <div class="card-body py-4">
    <table
      class="table align-middle table-row-dashed fs-6 gy-5"
      id="kt_table_tasks"
    >
      <thead>
        <tr class="text-start text-muted fw-bolder fs-7 text-uppercase gs-0">
          <th class="min-w-125px">Estudiante</th>
          <th class="min-w-125px">Fecha de Entrega</th>
          <th class="min-w-125px">Comentario</th>
          <th class="min-w-125px">Tipo de Archivo</th>
          <th class="text-end min-w-100px">Acciones</th>
        </tr>
      </thead>
      <tbody class="text-gray-600 fw-bold">
        <tr *ngFor="let studentTask of studentTasks">
          <td>{{ studentTask.student_name }}</td>
          <td>{{ studentTask.submitted_at | date : "dd/MM/yyyy HH:mm" }}</td>
          <td>{{ studentTask.comments }}</td>
          <td>{{ studentTask.file }}</td>
          <td class="text-end">
            <button
              (click)="viewFile(studentTask.file)"
              class="btn btn-light btn-active-light-primary btn-sm"
            >
              Ver Archivo
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<ng-container *ngIf="isLoading | async">
  <div class="overlay-layer bg-dark bg-opacity-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
  </div>
</ng-container>

<!-- Modal para visualizar archivos -->
<div
  class="modal fade"
  id="fileViewerModal"
  tabindex="-1"
  aria-labelledby="fileViewerModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="fileViewerModalLabel">Visor de Archivos</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <iframe
          id="fileViewer"
          width="100%"
          height="600px"
          frameborder="0"
        ></iframe>
      </div>
    </div>
  </div>
</div>
